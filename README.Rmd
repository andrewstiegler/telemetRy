---
title: "telemetRy: for interacting with telemetry data in R"
author: "Andrew Stiegler"
date: "3/1/2020"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(telemetRy)
```

## Description
This is a package for interacting with telemetry data using R. Specific 
functions for importing data from DSI telemetry systems are included, as well 
as functions for analyzing telemetry data over various timescales.

Note: the author of this package has no affiliation with 
[DSI](https://www.datasci.com)

## Installation
telemetRy is available on github. To install telemetRy, you'll need:    
[R > 3](https://www.r-project.org "R > 3.4")  
[devtools](https://github.com/r-lib/devtoolsdevtools "devtools") package from 
Hadley Wickham    
  
First, install devtools:
```{r eval=FALSE}
install.packages('devtools')
```
Then install telemetRy:
```{r eval=FALSE}
devtools::install_github(repo = 'andrewstiegler/telemetRy')
library(telemetRy)
```

## Calculating typical days from time series data
The typical_day function can be applied to dataframes with a time column to 
calculate the value of parameters over a single circadian cylcle. The dataframe 
must have a column with times and the user must specifythe beginning of the 
circadian cycle.
```{r eval=FALSE}
# For example, room lights turn on at 6AM
typical_day_output <- typical_day(data = time_series_data, lights_on = 6)
```


## Importing DSI data
First data must be exported from DSI's Ponemah software. 

To export data: with an experiment open, navigate to Experiment > Export Data. 
In this pop-up, select subjects to export, a timerange to export, and make sure 
to un-check "Pivot Compatible Sheets"

![Screenshot of DSI Ponemah export screen](images/ponemah_export_pivot.png)



Select "Export" and an Excel file will be generated. To import that Excel file 
into R, utilize the DSI_export_to_dataframe function:
```{r eval=FALSE}
exported_data <- DSI_export_to_dataframe('path_to_DSI_export')
```

The export will be a dataframe:
```{r echo=FALSE}
head(sample_BP_data)
```
Where the .id column indicates the subject serial number, and the Time column 
is the real time of data acquisition. Several useful time columns are generated, 
including a column for time-of-day only, and elapsed time since acquisition 
started in several units. The rest of the telemetry parameters are named.

## Other useful functions
Several functions are available for isolating parameters from datasets. 
Separate functions exist for the entire dataset or for typical_day averages. 
```{r eval=FALSE}
# To isolate SBP from a typical_day
isolated_typical_SBP <- isolate_typical(data = typical_day_output, 
                                              parameter = "SBP")
```

To isolate SBP from an entire DSI dataset:
```{r eval=TRUE}
# For example, to isolate SBP from entire dataset
export_data_sbp <- isolate_sbp(data = sample_BP_data)
export_data_sbp
```



